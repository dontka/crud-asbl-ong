<?php

/**
 * User Model
 * Based on Phase 4: Backend Development - Step 4.2 Specific Models
 * Handles user authentication and roles
 */

class User extends Model
{
    protected $table = 'users';

    /**
     * Validate user data
     * @param array $data
     * @return bool
     */
    public function validate($data)
    {
        if (empty($data['username']) || strlen($data['username']) < 3) {
            throw new Exception("Username must be at least 3 characters");
        }

        if (empty($data['email']) || !filter_var($data['email'], FILTER_VALIDATE_EMAIL)) {
            throw new Exception("Invalid email format");
        }

        if (empty($data['password'])) {
            throw new Exception("Password is required");
        }

        if (!$this->validatePassword($data['password'])) {
            throw new Exception("Password must be at least 8 characters with uppercase, lowercase, and number");
        }

        return true;
    }
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (empty($data['email']) || !filter_var($data['email'], FILTER_VALIDATE_EMAIL)) {
            throw new Exception("Invalid email address");
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!isset($data['role']) || !in_array($data['role'], ['admin', 'moderator', 'visitor'])) {
            $data['role'] = 'visitor'; // Default role
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        // Check for duplicate username
        if ($this->isUsernameTaken($data['username'], $data['id'] ?? null)) {
            throw new Exception("Username already taken");
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        // Check for duplicate email
        if ($this->isEmailTaken($data['email'], $data['id'] ?? null)) {
            throw new Exception("Email already taken");
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Authenticate user
     * @param string $username
     * @param string $password
     * @return array|null User data if authenticated
     */
    public function authenticate($username, $password)
    {
        try {
            $sql = "SELECT * FROM {$this->table
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
} WHERE username = ?";
            $stmt = $this->db->prepare($sql);
            $stmt->execute([$username]);
            $user = $stmt->fetch();

            if ($user && password_verify($password, $user['password'])) {
                unset($user['password']); // Don't return password
                return $user;
            
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

            return null;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
} catch (PDOException $e) {
            $this->logError("Authentication failed: " . $e->getMessage());
            throw new Exception("Authentication error");
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Save user (hash password if provided)
     * @param array $data
     * @return mixed
     */
    public function save($data)
    {
        // Hash password if provided
        if (isset($data['password']) && !empty($data['password'])) {
            $data['password'] = password_hash($data['password'], PASSWORD_DEFAULT);
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
} elseif (!isset($data[$this->primaryKey])) {
            throw new Exception("Password is required for new users");
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return parent::save($data);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Check if username is taken
     * @param string $username
     * @param int|null $excludeId
     * @return bool
     */
    private function isUsernameTaken($username, $excludeId = null)
    {
        $sql = "SELECT COUNT(*) FROM {$this->table
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
} WHERE username = ?";
        $params = [$username];

        if ($excludeId) {
            $sql .= " AND id != ?";
            $params[] = $excludeId;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        $stmt = $this->db->prepare($sql);
        $stmt->execute($params);
        return $stmt->fetchColumn() > 0;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Check if email is taken
     * @param string $email
     * @param int|null $excludeId
     * @return bool
     */
    private function isEmailTaken($email, $excludeId = null)
    {
        $sql = "SELECT COUNT(*) FROM {$this->table
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
} WHERE email = ?";
        $params = [$email];

        if ($excludeId) {
            $sql .= " AND id != ?";
            $params[] = $excludeId;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        $stmt = $this->db->prepare($sql);
        $stmt->execute($params);
        return $stmt->fetchColumn() > 0;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Get users by role
     * @param string $role
     * @return array
     */
    public function getByRole($role)
    {
        return $this->findBy('role', $role, 'username ASC');
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

        return true;
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    
    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}

    /**
     * Validate password strength
     * @param string $password
     * @return bool
     */
    public function validatePassword($password)
    {
        // Minimum 8 characters, at least one uppercase, one lowercase, one number
        if (strlen($password) < 8) {
            return false;
        }

        if (!preg_match("/[A-Z]/", $password)) {
            return false;
        }

        if (!preg_match("/[a-z]/", $password)) {
            return false;
        }

        if (!preg_match("/[0-9]/", $password)) {
            return false;
        }

        return true;
    }

    /**
     * Hash password securely
     * @param string $password
     * @return string
     */
    public function hashPassword($password)
    {
        return password_hash($password, PASSWORD_ARGON2ID, [
            'memory_cost' => 65536,
            'time_cost' => 4,
            'threads' => 3
        ]);
    }

    /**
     * Verify password
     * @param string $password
     * @param string $hash
     * @return bool
     */
    public function verifyPassword($password, $hash)
    {
        return password_verify($password, $hash);
    }
}
